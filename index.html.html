<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù„ÙŠÙ„Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --primary: #8b5cf6; --text: #f8fafc; }
        body { background: var(--bg); color: var(--text); font-family: 'Tajawal', sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .card { background: var(--card); padding: 25px; border-radius: 20px; text-align: center; width: 90%; max-width: 380px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        button { width: 100%; padding: 15px; border: none; border-radius: 12px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 1.1rem; }
        .hidden { display: none !important; }
        .room-tag { font-size: 2rem; color: #10b981; font-weight: 900; display: block; margin: 10px 0; }
    </style>
</head>
<body>

<div id="s1" class="card">
    <h1>ğŸº Ù„ÙŠÙ„Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨</h1>
    <input type="text" id="name" placeholder="Ø§Ø³Ù…Ùƒ" style="width:100%; padding:15px; border-radius:10px; border:none; text-align:center;">
    <button onclick="goS2()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="s2" class="card hidden">
    <button onclick="create()">â• Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©</button>
    <input type="number" id="roomIn" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©" style="width:100%; padding:15px; margin-top:10px; border-radius:10px; text-align:center;">
    <button style="background:#475569" onclick="join()">ğŸ”— Ø§Ù†Ø¶Ù…Ø§Ù…</button>
</div>

<div id="s3" class="card hidden">
    <h3>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: <span id="codeDisp" class="room-tag"></span></h3>
    <div id="list" style="margin:20px 0; text-align:right;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</div>
    <button id="startB" class="hidden" style="background:#10b981" onclick="sendGo()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ù„Ù„ÙƒÙ„</button>
</div>

<div id="s4" class="card hidden">
    <h2>Ø¯ÙˆØ±Ùƒ: <span id="role" style="color:#8b5cf6"></span></h2>
    <button onclick="location.reload()" style="background:#ef4444">Ø®Ø±ÙˆØ¬</button>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://wolf-online-default-rtdb.firebaseio.com" };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let uName, rID, host = false;

    function goS2() { uName = document.getElementById('name').value; if(uName) show('s2'); }
    function create() { host = true; rID = Math.floor(1000 + Math.random() * 9000); start(); }
    function join() { rID = document.getElementById('roomIn').value; if(rID) start(); }

    function start() {
        show('s3'); document.getElementById('codeDisp').innerText = rID;
        const ref = db.ref('rooms/' + rID);
        ref.child('players').push({ name: uName, host: host }).onDisconnect().remove();
        if(host) document.getElementById('startB').classList.remove('hidden');

        ref.child('players').on('value', s => {
            let h = ""; s.forEach(p => { h += `<div>ğŸ‘¤ ${p.val().name}</div>`; });
            document.getElementById('list').innerHTML = h;
        });

        ref.child('status').on('value', s => {
            if(s.val() === "GO") {
                show('s4');
                const rs = ["Ø°Ø¦Ø¨ ğŸº", "Ø·Ø¨ÙŠØ¨ ğŸ¥", "Ù…Ø­Ù‚Ù‚ ğŸ”", "Ù…ÙˆØ§Ø·Ù† ğŸ‘¤"];
                document.getElementById('role').innerText = rs[Math.floor(Math.random()*rs.length)];
            }
        });
    }

    function sendGo() { db.ref('rooms/' + rID + '/status').set("GO"); }
    function show(id) { ['s1','s2','s3','s4'].forEach(i => document.getElementById(i).classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); }
</script>
</body>
</html>