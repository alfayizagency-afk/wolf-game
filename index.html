<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù„ÙŠÙ„Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ù„ÙŠÙ„Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --primary: #8b5cf6; --text: #f8fafc; }
        body { background: var(--bg); color: var(--text); font-family: 'Tajawal', sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        .card { background: var(--card); padding: 30px; border-radius: 25px; text-align: center; width: 85%; max-width: 400px; box-shadow: 0 15px 35px rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.1); }
        button { width: 100%; padding: 18px; border: none; border-radius: 15px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; margin-top: 15px; font-size: 1.2rem; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3); }
        input { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #334155; margin-bottom: 15px; text-align: center; font-size: 1.2rem; background: #0f172a; color: white; outline: none; box-sizing: border-box; }
        .hidden { display: none !important; }
        .player-list { margin: 20px 0; text-align: right; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px; max-height: 150px; overflow-y: auto; }
    </style>
</head>
<body>

<div id="s1" class="card">
    <h1>ğŸº Ù„ÙŠÙ„Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨</h1>
    <input type="text" id="nn" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
    <button onclick="go2()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
</div>

<div id="s2" class="card hidden">
    <button onclick="cr()">â• Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
    <p>Ø£Ùˆ</p>
    <input type="number" id="ri" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
    <button style="background:#475569" onclick="jn()">ğŸ”— Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØµØ¯ÙŠÙ‚</button>
</div>

<div id="s3" class="card hidden">
    <h3>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: <span id="cc" style="color:#10b981; font-size: 2rem;"></span></h3>
    <div class="player-list" id="pl"></div>
    <button id="bb" class="hidden" style="background:#10b981" onclick="sg()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¢Ù†</button>
    <p id="wm">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ù†Ø´Ø¦...</p>
</div>

<div id="s4" class="card hidden">
    <h2>Ø¯ÙˆØ±Ùƒ Ù‡Ùˆ:</h2>
    <div style="font-size: 2.5rem; padding: 20px; color: #8b5cf6;" id="rr"></div>
    <button onclick="location.reload()" style="background:#ef4444">Ø®Ø±ÙˆØ¬</button>
</div>

<script>
    const cfg = { databaseURL: "https://wolf-online-default-rtdb.firebaseio.com" };
    if (!firebase.apps.length) firebase.initializeApp(cfg);
    const db = firebase.database();
    let un, rd, h = false;

    function go2() { un = document.getElementById('nn').value; if(un) show('s2'); }
    function cr() { h = true; rd = Math.floor(1000 + Math.random() * 9000); st(); }
    function jn() { rd = document.getElementById('ri').value; if(rd) st(); }

    function st() {
        show('s3'); document.getElementById('cc').innerText = rd;
        const ref = db.ref('rooms/' + rd);
        ref.child('p').push({ n: un, h: h }).onDisconnect().remove();
        if(h) { document.getElementById('bb').classList.remove('hidden'); document.getElementById('wm').classList.add('hidden'); }
        
        ref.child('p').on('value', s => {
            let t = "<b>Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙˆÙ†:</b>";
            s.forEach(p => { t += `<div>ğŸ‘¤ ${p.val().n}</div>`; });
            document.getElementById('pl').innerHTML = t;
        });

        ref.child('s').on('value', s => {
            if(s.val() === "G") {
                show('s4');
                const rs = ["Ø°Ø¦Ø¨ ğŸº", "Ø·Ø¨ÙŠØ¨ ğŸ¥", "Ù…Ø­Ù‚Ù‚ ğŸ”", "Ù…ÙˆØ§Ø·Ù† ğŸ‘¤", "Ù…ÙˆØ§Ø·Ù† ğŸ‘¤"];
                document.getElementById('rr').innerText = rs[Math.floor(Math.random()*rs.length)];
            }
        });
    }

    function sg() { db.ref('rooms/' + rd + '/s').set("G"); }
    function show(i) { document.querySelectorAll('.card').forEach(x => x.classList.add('hidden')); document.getElementById(i).classList.remove('hidden'); }
</script>
</body>
</html>
